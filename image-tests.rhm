#lang rhombus
import "image.rhm" open

// TODO : add more unit tests for text, place_image, & c.
//        add more tests for the 3 align functions and for the place functions

// mode_to_color
check mode_to_color("solid") ~is [#'inherit,1]
check mode_to_color("outline") ~is [#false,1]
check mode_to_color(11) ~is [#'inherit,11/255]

// circle
check circle(30,"outline","red").width ~is 60
check circle(30,"outline","red").height ~is 60
check circle(20,"solid","blue").width ~is 40
check circle(20,"solid","blue").height ~is 40
check circle(0,100,"blue").width ~is 0
check circle(0,100,"blue").height ~is 0

// ellipse
check ellipse(60,30,"outline","black").width ~is 60
check ellipse(60,30,"outline","black").height ~is 30
check ellipse(30,60,"solid","blue").width ~is 30
check ellipse(30,60,"solid","blue").height ~is 60
check ellipse(30,60,100,"blue").width ~is 30
check ellipse(30,60,100,"blue").height ~is 60

// line
check line(30,30,"black").width ~is 30
check line(30,30,"black").height ~is 30
check line(-30,20,"red").width ~is -30
check line(-30,20,"red").height ~is 20
check line(30,-20,"red").width ~is 30
check line(30,-20,"red").height ~is -20
check line(10,0,"red").width ~is 10
check line(10,0,"red").height ~is 0
check line(0,10,"red").width ~is 0
check line(0,10,"red").height ~is 10
check line(0,0,"red").width ~is 0
check line(0,0,"red").height ~is 0

// triangle
check triangle(100,255,"red").width ~is 100
check triangle(100,255,"red").height ~is 87.0
check triangle(40,255,"red").width ~is 40
check triangle(40,255,"red").height ~is 35.0

// square
check square(30,255,"red").width ~is 30
check square(30,255,"red").height ~is 30
check square(40,"solid","slateblue").width ~is 40
check square(40,"solid","slateblue").height ~is 40
check square(50,"outline","darkmagenta").width ~is 50
check square(50,"outline","darkmagenta").height ~is 50

// rectangle
check rectangle(100,90,255,"red").width ~is 100
check rectangle(100,90,255,"red").height ~is 90
check rectangle(40,20,"outline","black").width ~is 40
check rectangle(40,20,"outline","black").height ~is 20
check rectangle(20,40,"solid","blue").width ~is 20
check rectangle(20,40,"solid","blue").height ~is 40

// rhombus
check rhombus(40,45,"solid","magenta").width ~is 31.0
check rhombus(40,45,"solid","magenta").height ~is 74.0
check rhombus(80,150,"solid","mediumpurple").width ~is 155.0
check rhombus(80,150,"solid","mediumpurple").height ~is 41.0

// star
check star(40,"solid","gray").width ~is 65.0
check star(40,"solid","gray").height ~is 62.0

// overlay
check overlay(rectangle(30,60,"solid","orange"),ellipse(60,30,"solid","purple")).width ~is 60
check overlay(rectangle(30,60,"solid","orange"),ellipse(60,30,"solid","purple")).height ~is 60
check overlay(ellipse(10,10,"solid","red"),
              ellipse(20,20,"solid","black"),
              ellipse(30,30,"solid","red"),
              ellipse(40,40,"solid","black"),
              ellipse(50,50,"solid","red"),
              ellipse(60,60,"solid","black"),).width ~is 60
check overlay(ellipse(10,10,"solid","red"),
              ellipse(20,20,"solid","black"),
              ellipse(30,30,"solid","red"),
              ellipse(40,40,"solid","black"),
              ellipse(50,50,"solid","red"),
              ellipse(60,60,"solid","black"),).height ~is 60

// beside
check beside(ellipse(20,70,"solid","gray"),
             ellipse(20,50,"solid","darkgray"),
             ellipse(20,30,"solid","dimgray"),
             ellipse(20,10,"solid","black")).width ~is 80
check beside(ellipse(20,70,"solid","gray"),
             ellipse(20,50,"solid","darkgray"),
             ellipse(20,30,"solid","dimgray"),
             ellipse(20,10,"solid","black")).height ~is 70

// above
check above(ellipse(70,20,"solid","gray"),
            ellipse(50,20,"solid","darkgray"),
            ellipse(30,20,"solid","dimgray"),
            ellipse(10,20,"solid","white")).width ~is 70
check above(ellipse(70,20,"solid","gray"),
            ellipse(50,20,"solid","darkgray"),
            ellipse(30,20,"solid","dimgray"),
            ellipse(10,20,"solid","white")).height ~is 80

// empty_scene
check empty_scene(160,90).width ~is 160
check empty_scene(160,90).height ~is 90
check empty_scene(200,200).width ~is 200
check empty_scene(200,200).height ~is 200

// scene_line
check scene_line(ellipse(40,40,"outline","maroon"),0,40,40,0,"maroon").width ~is 40
check scene_line(ellipse(40,40,"outline","maroon"),0,40,40,0,"maroon").height ~is 40
check scene_line(rectangle(40,40,"solid","gray"),0,40,40,0,"maroon").width ~is 40
check scene_line(rectangle(40,40,"solid","gray"),0,40,40,0,"maroon").height ~is 40
check scene_line(rectangle(100,100,"solid","darkolivegreen"),25,25,100,100,"goldenrod").width ~is 100
check scene_line(rectangle(100,100,"solid","darkolivegreen"),25,25,100,100,"goldenrod").height ~is 100
check scene_line(ellipse(0,0,"outline","maroon"),0,40,40,0,"maroon").width ~is 0
check scene_line(ellipse(0,0,"outline","maroon"),0,40,40,0,"maroon").height ~is 0

// scale_xy
check scale_xy(2,3,rectangle(100,90,255,"red")).width ~is 200
check scale_xy(2,3,rectangle(100,90,255,"red")).height ~is 270
check scale_xy(3,2,ellipse(20,30,"solid","blue")).width ~is 60
check scale_xy(3,2,ellipse(20,30,"solid","blue")).height ~is 60